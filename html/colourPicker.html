<div id="ColourPickerWindow" class="ColourPicker">
    <div id="ColourPicker-body" class="ColourPicker-body">
    </div>
</div>


<script>

    function ColourPicker_setContent(content) {
        var ColourPicker = document.getElementById("ColourPicker-body")
        ColourPicker.innerHTML = content;
        //showColourPicker();
    }
	
	
	    function ColourPicker_appendContent(content) {
        ColourPicker_clearContent();
        var ColourPicker = document.getElementById("ColourPicker-body");
        ColourPicker.appendChild(content);
        //showColourPicker();
    }

    function ColourPicker_clearContent() {
        var ColourPicker = document.getElementById("ColourPicker-body")
        ColourPicker.innerHTML = '';
    }
	
    function showColourPicker(ev, callback, caller) {
        document.getElementById('ColourPickerWindow').style.display = "block";
        positionColourPicker(ev);
		
		
		var ColourPicker_table = document.createElement("div");
        ColourPicker_table.className = "ColourPicker-table";
        ColourPicker_table.id = "ColourPicker-table";

        var colours = [1, 2, 3, 4, 5, 6, 230, 30, 7, 8, 9, 256]

        for (var i = 0; i < colours.length; i++) {
        var ACIColour = document.createElement("div");
        ACIColour.className = "Design-shape"
        ACIColour.style.backgroundColor = getHexColour(colours[i]);
        ACIColour.id = getHexColour(colours[i]);
        ACIColour.onmousedown = function(e) {
        //LM.layers[layerIndex].colour = this.id;
        //console.log(" selected colour " + this.id);
		
        //return selected colour and redraw canvas
        closeColourPicker()
        canvas.requestPaint()
		var selectedColour = this.id;
		callback(selectedColour, caller);

        };

        ColourPicker_table.appendChild(ACIColour);
                    }
      
	  ColourPicker_appendContent(ColourPicker_table)
		
    }
	
	

    function closeColourPicker() {
        document.getElementById('ColourPickerWindow').style.display = "none";
    }

    function positionColourPicker(ev) {
        var clickCoords = getPosition(ev);
        var clickCoordsX = clickCoords.x;
        var clickCoordsY = clickCoords.y;
        var ColourPicker = document.getElementById('ColourPicker-body');

        ColourPickerWidth = ColourPicker.offsetWidth + 4;
        ColourPickerHeight = ColourPicker.offsetHeight + 4;

        windowWidth = window.innerWidth;
        windowHeight = window.innerHeight;

        if ((windowWidth - clickCoordsX) < ColourPickerWidth) {
            ColourPicker.style.left = windowWidth - ColourPickerWidth + "px";
        } else {
            ColourPicker.style.left = clickCoordsX - (ColourPickerWidth / 2) + "px";
        }

        if ((windowHeight - clickCoordsY) < ColourPickerHeight) {
            ColourPicker.style.top = windowHeight - ColourPickerHeight - 10 + "px";
        } else {
            ColourPicker.style.top = clickCoordsY + 10 + "px";
        }
    }

    function getPosition(ev) {
        var posx = 0;
        var posy = 0;

        if (!e) var e = window.event;

        if (e.pageX || e.pageY) {
            posx = e.pageX;
            posy = e.pageY;
        } else if (e.clientX || e.clientY) {
            posx = e.clientX + document.body.scrollLeft + document.documentElement.scrollLeft;
            posy = e.clientY + document.body.scrollTop + document.documentElement.scrollTop;
        }

        return {
            x: posx,
            y: posy
        }
    }

    // When the user clicks anywhere outside of the dialogs, close them
    window.onclick = function(event) {
        if (event.target == document.getElementById('ColourPickerWindow')) {
            document.getElementById('ColourPickerWindow').style.display = "none";
        }
    }

    //import this document in to the Design.html Document
    var import1 = document.currentScript.ownerDocument.querySelector("#ColourPickerWindow");
    document.body.appendChild(document.currentScript.ownerDocument.importNode(import1, true));

</script>
